---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

```{r, echo=TRUE}
library(ggplot2)
```

## Loading and preprocessing the data

First, we'll download the data and unzip in our working directory

```{r, echo=TRUE}
fileURL <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
fileName <- "activity.zip"

#download the file:
download.file(fileURL, destfile = fileName, method = "curl")

#unzip the file:
unzip(fileName)
```

Next, we'll read the data into R and prep it for analysis
```{r, echo=TRUE}
#read the csv
activity_data <- read.csv("activity.csv", na.strings = "NA")

#convert date to date class
activity_data$date <- as.Date(activity_data$date, "%Y-%m-%d")

```


## What is mean total number of steps taken per day?
Here we're taking a look at the distribution of total number of steps per day. Note that missing values (NA's) are being removed.

```{r, echo=TRUE}
#use tapply to calculate the total per day
total_steps <- tapply(activity_data$steps, activity_data$date, sum,  na.rm = TRUE)

#plot histogram showing the distribution of total steps per day
qplot(total_steps, binwidth=1000, xlab="Total Number of Steps", ylab = "Frequency", main = "Distribution of Total Steps Per Day")
```

Next, let's look at the mean & median of the total steps per day.

```{r, echo=TRUE}
#calculate the mean
mean(total_steps, na.rm = TRUE)
```
The mean is 9,354.

```{r, echo=TRUE}
#calculate the median
median(total_steps, na.rm = TRUE)
```
The median is 10,395.


## What is the average daily activity pattern?

First, we'll take a look at the average number of steps per 5-minute interval

```{r, echo=TRUE}
# calculate the average number of steps by interval
interval_avg_steps <- aggregate(x = list(steps = activity_data$steps), by = list(interval =  activity_data$interval), FUN = mean, na.rm = TRUE)

# plot the data
ggplot(data = interval_avg_steps, aes(x = interval, y = steps)) + geom_line() + xlab("5-minute interval") + ylab("Average Number of Steps")
```

Next, we find the interval which has the highest average of steps
```{r, echo=TRUE}
interval_avg_steps[which.max(interval_avg_steps$steps), ]
```
Interval 835 has the highest average, with 206 steps


## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?